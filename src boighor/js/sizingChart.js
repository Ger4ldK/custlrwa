var men_tops = [
    {
        "uk": "34",
        "us": "34",
        "eu": "44",
        "intl": "XS",
        "tops": {
            "chest": "35.5",
            "low_waist": "31",
            "hip": "35.75",
            "arm": "32.5"
        }
    },
    {
        "uk": "36",
        "us": "36",
        "eu": "46",
        "intl": "S",
        "tops": {
            "chest": "37",
            "low_waist": "32.5",
            "hip": "37.5",
            "arm": "33"
        }
    },
    {
        "uk": "38",
        "us": "38",
        "eu": "48",
        "intl": "M",
        "tops": {
            "chest": "38.5",
            "low_waist": "34",
            "hip": "39",
            "arm": "33.5"
        }
    },
    {
        "uk": "40",
        "us": "40",
        "eu": "50",
        "intl": "L",
        "tops": {
            "chest": "40.25",
            "low_waist": "35.5",
            "hip": "40.5",
            "arm": "34.25"
        }
    },
    {
        "uk": "42",
        "us": "42",
        "eu": "52",
        "intl": "XL",
        "tops": {
            "chest": "41.75",
            "low_waist": "37.25",
            "hip": "42.75",
            "arm": "34.5"
        }
    },
    {
        "uk": "44",
        "us": "44",
        "eu": "54",
        "intl": "XXL",
        "tops": {
            "chest": "43.25",
            "low_waist": "38.75",
            "hip": "43.75",
            "arm": "35"
        }
    },
    {
        "uk": "46",
        "us": "46",
        "eu": "56",
        "intl": "XXXL",
        "tops": {
            "chest": "44.75",
            "low_waist": "40.25",
            "hip": "45.25",
            "arm": "35.5"
        }
    }
];

var men_bottoms = [
    {
        "uk": "28",
        "us": "28",
        "eu": "44",
        "intl": "XS",
        "bottoms": {
            "low_waist": "31",
            "hip": "35.75",
            "inner_leg": "33.5"
        }
    },
    {
        "uk": "32",
        "us": "32",
        "eu": "46",
        "intl": "S",
        "bottoms": {
            "low_waist": "32.5",
            "hip": "37.5",
            "inner_leg": "33.5"
        }
    },
    {
        "uk": "34",
        "us": "34",
        "eu": "48",
        "intl": "M",
        "bottoms": {
            "low_waist": "34",
            "hip": "39",
            "inner_leg": "33.5"
        }
    },
    {
        "uk": "36",
        "us": "36",
        "eu": "50",
        "intl": "L",
        "bottoms": {
            "low_waist": "35.5",
            "hip": "40.5",
            "inner_leg": "33.5"
        }
    },
    {
        "uk": "38",
        "us": "38",
        "eu": "52",
        "intl": "XL",
        "bottoms": {
            "low_waist": "37.25",
            "hip": "42.25",
            "inner_leg": "33.5"
        }
    },
    {
        "uk": "40",
        "us": "40",
        "eu": "54",
        "intl": "XXL",
        "bottoms": {
            "low_waist": "38.75",
            "hip": "43.75",
            "inner_leg": "33.5"
        }
    },
    {
        "uk": "42",
        "us": "42",
        "eu": "56",
        "intl": "XXXL",
        "bottoms": {
            "low_waist": "40.25",
            "hip": "45.25",
            "inner_leg": "33.5"
        }
    }
];

var women = [
    {
        "uk": "2",
        "us": "00",
        "eu": "30",
        "intl": "XS"
    },
    {
        "uk": "4",
        "us": "0",
        "eu": "32",
        "intl": "XS"
    },
    {
        "uk": "6",
        "us": "2",
        "eu": "34",
        "intl": "S"
    },
    {
        "uk": "8",
        "us": "4",
        "eu": "36",
        "intl": "S"
    },
    {
        "uk": "10",
        "us": "6",
        "eu": "38",
        "intl": "M"
    },
    {
        "uk": "12",
        "us": "8",
        "eu": "40",
        "intl": "M"
    },
    {
        "uk": "14",
        "us": "10",
        "eu": "42",
        "intl": "L"
    }
];

var women_tops = [
    {
        "uk": "2",
        "us": "00",
        "eu": "30",
        "intl": "XS",
        "tops":{
            "bust": "30",
            "waist": "23",
            "hip": "33",
            "arm": "30"
        }
    },
    {
        "uk": "4",
        "us": "0",
        "eu": "32",
        "intl": "XS",
        "tops":{
            "bust": "31",
            "waist": "24",
            "hip": "34",
            "arm": "30"
        }
    },
    {
        "uk": "6",
        "us": "2",
        "eu": "34",
        "intl": "S",
        "tops":{
            "bust": "32",
            "waist": "25",
            "hip": "35",
            "arm": "30.75"
        }
    },
    {
        "uk": "8",
        "us": "4",
        "eu": "36",
        "intl": "S",
        "tops":{
            "bust": "33",
            "waist": "26",
            "hip": "36",
            "arm": "30.75"
        }
    },
    {
        "uk": "10",
        "us": "6",
        "eu": "38",
        "intl": "M",
        "tops":{
            "bust": "35",
            "waist": "28",
            "hip": "38",
            "arm": "31.25"
        }
    },
    {
        "uk": "12",
        "us": "8",
        "eu": "40",
        "intl": "M",
        "tops":{
            "bust": "37",
            "waist": "30",
            "hip": "40",
            "arm": "31.25"
        }
    },
    {
        "uk": "14",
        "us": "10",
        "eu": "42",
        "intl": "L",
        "tops":{
            "bust": "39",
            "waist": "32",
            "hip": "42",
            "arm": "31.5"
        }
    }
];

var women_bottoms = [
    {
        "uk": "2",
        "us": "00",
        "eu": "30",
        "intl": "XS",
        "bottoms":{
            "low_waist": "30.75",
            "hip": "35.5",
            "inner_leg": "32.25"
        }
    },
    {
        "uk": "4",
        "us": "0",
        "eu": "32",
        "intl": "XS",
        "bottoms":{
            "low_waist": "30.75",
            "hip": "35.5",
            "inner_leg": "32.25"
        }
    },
    {
        "uk": "6",
        "us": "2",
        "eu": "34",
        "intl": "S",
        "bottoms":{
            "low_waist": "32.25",
            "hip": "37",
            "inner_leg": "32.5"
        }
    },
    {
        "uk": "8",
        "us": "4",
        "eu": "36",
        "intl": "S",
        "bottoms":{
            "low_waist": "32.25",
            "hip": "37",
            "inner_leg": "32.5"
        }
    },
    {
        "uk": "10",
        "us": "6",
        "eu": "38",
        "intl": "M",
        "bottoms":{
            "low_waist": "33.75",
            "hip": "38.5",
            "inner_leg": "33"
        }
    },
    {
        "uk": "12",
        "us": "8",
        "eu": "40",
        "intl": "M",
        "bottoms":{
            "low_waist": "33.75",
            "hip": "38.5",
            "inner_leg": "33"
        }
    },
    {
        "uk": "14",
        "us": "10",
        "eu": "42",
        "intl": "L",
        "bottoms":{
            "low_waist": "35.5",
            "hip": "40",
            "inner_leg": "33.5"
        }
    }
];

var noTypeSizing = {
    "uk": "0",
    "us": "0",
    "eu": "0",
    "intl": "0"
}


function sizingDetection(sizeType, gender, category){ 
    var sizingType = '';
    if (gender == 'Men'){
        if (sizeType == "UK"){
            if (category == 'tops'){
                sizingType = 'us_uk_men_tops'; //same sizing for both
            }
            else{
                sizingType = 'us_uk_men_';
            }
        }
        else if (sizeType == "EU") {
            if (category == 'tops'){
                sizingType = 'eu_men_tops';
            }
            else{
                sizingType = 'eu_men_bottoms'
            }
        }
        else if (sizeType == "International"){
            if(category == 'tops'){
                sizingType = 'intl_men_tops';    
            }
            else{
                sizingType = 'intl_men_bottoms';
            }
        }
        else{
            sizingType = 'notype'
        }       
    }
    else if (gender === 'Women'){ //add for bottoms
        if (sizeType == "UK"){
            sizingType = 'uk_women'; //same sizing for both
        }
        else if(sizeType == "US"){
                sizingType = 'us_women';
        }
        else if (sizeType == "EU") {
            sizingType = 'eu_women';
        }
        else if (sizeType == "International"){
            sizingType = 'intl_women';
        }
        else{
            sizingType = 'notype'
        } 
    }
    else { //Kids
        sizingType = 'notype'
    }
    return sizingType;
}

function sizingList(sizing_original, sizeType, gender){
    var sizing_list = []
    var category = 'tops'; //once we get subcategory in the db this can be removed and added as arg for the function
    var sizingType = sizingDetection(sizeType, gender, category)
    var i=0, j=0;
    switch(sizingType){
        case 'us_uk_men_tops':
            //for loop to look through the original sizing list, match with sizes on the input sizing for this function, then += to sizing_list
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<men_tops.length; j++){
                    if (sizing_original[i].sizing == men_tops[j].uk || sizing_original[i].sizing == men_tops[j].us){
                        sizing_list.push(men_tops[j]);
                    };
                };
            };
            break;
        case 'us_uk_men_bottoms':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<men_bottoms.length; j++){
                    if (sizing_original[i].sizing == men_bottoms[j].uk || sizing_original[i].sizing == men_bottoms[j].us){
                        sizing_list.push(men_bottoms[j]);
                    };
                };
            };
            break;
        case 'eu_men_tops':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<men_tops.length; j++){
                    if (sizing_original[i].sizing == men_tops[j].uk){
                        sizing_list.push(men_tops[j]);
                    };
                };
            };
            break;
        case 'eu_men_bottoms':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<men_bottoms.length; j++){
                    if (sizing_original[i].sizing == men_bottoms[j].eu){
                        sizing_list.push(men_bottoms[j]);
                    };
                };
            };
            break;
        case 'intl_men_tops':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<men_tops.length; j++){
                    if (sizing_original[i].sizing == men_tops[j].intl){
                        sizing_list.push(men_tops[j]);
                    };
                };
            };
            break;
        case 'intl_men_bottoms':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<men_bottoms.length; j++){
                    if (sizing_original[i].sizing == men_bottoms[j].intl){
                        sizing_list.push(men_bottoms[j]);
                    };
                };
            };
            break;
        case 'us_women':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<women.length; j++){
                    if (sizing_original[i].sizing == women[j].us){
                        sizing_list.push(women[j]);
                    };
                };
            };
            break;
        case 'uk_women':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<women.length; j++){
                    if (sizing_original[i].sizing == women[j].uk){
                        sizing_list.push(women[j]);
                    };
                };
            };
            break;
        case 'eu_women':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<women.length; j++){
                    if (sizing_original[i].sizing == women[j].eu){
                        sizing_list.push(women[j]);
                    };
                };
            };
            break;
        case 'intl_women':
            for (i=0; i<sizing_original.length; i++){
                for(j=0; j<women.length; j++){
                    if (sizing_original[i].sizing == women[j].intl){
                        sizing_list.push(women[j]);
                    };
                };
            };
            break;
        case 'notype':
            for (i=0; i<sizing_original.length; i++){
                noTypeSizing.uk = sizing_original[i].sizing;
                noTypeSizing.us = sizing_original[i].sizing;
                noTypeSizing.eu = sizing_original[i].sizing;
                noTypeSizing.intl = sizing_original[i].sizing;

                sizing_list.push(noTypeSizing);
            };
            break;
        default:
            for (i=0; i<sizing_original.length; i++){
                noTypeSizing.uk = sizing_original[i].sizing;
                noTypeSizing.us = sizing_original[i].sizing;
                noTypeSizing.eu = sizing_original[i].sizing;
                noTypeSizing.intl = sizing_original[i].sizing;

                sizing_list.push(noTypeSizing);
            }

    }
    return sizing_list
}

function sizing_match(user_sizing, size, type, gender){ // user measurements, available sizes(sizing_chart), type(top/bottom), gender
    if (type == 'tops'){
        top_match(user_sizing, size, gender);
    }
    else{ //bottoms
        bottom_match(user_sizing, size, gender);
    }
};
//todo tops_women, bottoms_men, bottoms_women
function top_match(user, size, gender){
    //get difference between specific lengths, then calculate match for sizing based on weightage of the size
    if (gender == 'men'){
        tops_men(user, size);
    }
    else{
        tops_women(user, size);
    }
}
function compare(first, second){
    //comparison and sort, higher score == better

    var comparison = 0;
    if (first.score > second.score){
        comparison = 1;
    } else if (first.score < second.score){
        comparison = -1;
    } else if (first.orignal.uk > second.original.uk){
        comparison = 1;
    } else if (first.orignal.uk < second.original.uk){
        comparison = -1;
    };
    return comparison;
};

function tops_men(user, size){
    var scores = [];  //'score' given at the end. best(highest) score is most reccomended size.
    //user gives all sizes in this format
    /*
    { "chest": "41"
    , "low_waist": "34"
    , "hip": "40"
    , "arm": "33"
    }
    */
    //original sizes are in this format
    /*
    {
        "uk": "46",
        "us": "46",
        "eu": "56",
        "intl": "XXXL",
        "tops": {
            "chest": "44.75",
            "low_waist": "40.25",
            "hip": "45.25",
            "arm": "35.5"
        }
    }
    */
    
    //compare and give a 'score' for all the available sizes
    for (i=0; i < size.length; i++){
        //each part of the body should have some weightage
        //these numbers are not 100% final, could change as time goes on, this is just a rough idea for implementation right now
        var sizing = size[i].tops;
        var score = 0;

        var chest = (user.chest - sizing.chest);
        if (chest <= 0 && chest >= -0.5){
            score += 0.25;
        };

        var low_waist = (user.low_waist - sizing.low_waist);
        if (low_waist <= 0 && low_waist >= -0.75){
            score += 0.35;
        };

        var hip = (user.hip - sizing.hip);
        if (hip <= 0 && hip >= -0.65){
            score += 0.25;
        };

        var arm = (user.arm - sizing.arm);
        if (arm <= 0 && arm >= -0.45){
            score += 0.15;
        };
        
        //use the different weighted scores now to get the final score
        var original = {
            "uk": size[i].uk,
            "us": size[i].us,
            "eu": size[i].eu,
            "intl": size[i],intl
        };
        
        score *=100;
        scores.push({score, orignal});
    }
    scores = scores.sort(compare);

}